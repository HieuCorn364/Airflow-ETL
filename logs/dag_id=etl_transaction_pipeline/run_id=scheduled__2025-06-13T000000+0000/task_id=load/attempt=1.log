{"timestamp":"2025-06-13T04:19:49.635044","level":"info","event":"DAG bundles loaded: dags-folder, example_dags","logger":"airflow.dag_processing.bundles.manager.DagBundlesManager"}
{"timestamp":"2025-06-13T04:19:49.635583","level":"info","event":"Filling up the DagBag from /opt/airflow/dags/etl_dag.py","logger":"airflow.models.dagbag.DagBag"}
{"timestamp":"2025-06-13T04:19:49.684534Z","level":"info","event":"Task instance is in running state","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-13T04:19:49.685362Z","level":"info","event":" Previous state of the Task instance: TaskInstanceState.QUEUED","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-13T04:19:49.686051Z","level":"info","event":"Current task name:load","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-13T04:19:49.686632Z","level":"info","event":"Dag name:etl_transaction_pipeline","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-13T04:20:19.095873","level":"error","event":"Task failed with exception","logger":"task","error_detail":[{"exc_type":"IntegrityError","exc_value":"(psycopg2.errors.UniqueViolation) duplicate key value violates unique constraint \"pg_type_typname_nsp_index\"\nDETAIL:  Key (typname, typnamespace)=(transactions, 2200) already exists.\n\n[SQL: \nCREATE TABLE transactions (\n\t\"Transaction_ID\" FLOAT(53), \n\t\"Customer_ID\" FLOAT(53), \n\t\"Name\" TEXT, \n\t\"Email\" TEXT, \n\t\"Phone\" FLOAT(53), \n\t\"Address\" TEXT, \n\t\"City\" TEXT, \n\t\"State\" TEXT, \n\t\"Zipcode\" FLOAT(53), \n\t\"Country\" TEXT, \n\t\"Age\" FLOAT(53), \n\t\"Gender\" TEXT, \n\t\"Income\" TEXT, \n\t\"Customer_Segment\" TEXT, \n\t\"Date\" TEXT, \n\t\"Year\" FLOAT(53), \n\t\"Month\" TEXT, \n\t\"Time\" TEXT, \n\t\"Total_Purchases\" FLOAT(53), \n\t\"Amount\" FLOAT(53), \n\t\"Total_Amount\" FLOAT(53), \n\t\"Product_Category\" TEXT, \n\t\"Product_Brand\" TEXT, \n\t\"Product_Type\" TEXT, \n\t\"Feedback\" TEXT, \n\t\"Shipping_Method\" TEXT, \n\t\"Payment_Method\" TEXT, \n\t\"Order_Status\" TEXT, \n\t\"Ratings\" FLOAT(53), \n\tproducts TEXT, \n\t\"Tax\" FLOAT(53)\n)\n\n]\n(Background on this error at: https://sqlalche.me/e/14/gkpj)","exc_notes":[],"syntax_error":null,"is_cause":false,"frames":[{"filename":"/home/airflow/.local/lib/python3.12/site-packages/airflow/sdk/execution_time/task_runner.py","lineno":838,"name":"run"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/airflow/sdk/execution_time/task_runner.py","lineno":1130,"name":"_execute_task"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/airflow/sdk/bases/operator.py","lineno":408,"name":"wrapper"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/airflow/providers/standard/operators/python.py","lineno":212,"name":"execute"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/airflow/providers/standard/operators/python.py","lineno":235,"name":"execute_callable"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/airflow/sdk/execution_time/callback_runner.py","lineno":81,"name":"run"},{"filename":"/opt/airflow/dags/etl_dag.py","lineno":27,"name":"load"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/pandas/util/_decorators.py","lineno":333,"name":"wrapper"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/pandas/core/generic.py","lineno":3008,"name":"to_sql"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/pandas/io/sql.py","lineno":788,"name":"to_sql"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/pandas/io/sql.py","lineno":1948,"name":"to_sql"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/pandas/io/sql.py","lineno":1852,"name":"prep_table"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/pandas/io/sql.py","lineno":936,"name":"create"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/pandas/io/sql.py","lineno":922,"name":"_execute_create"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/sqlalchemy/sql/schema.py","lineno":962,"name":"create"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/sqlalchemy/engine/base.py","lineno":2221,"name":"_run_ddl_visitor"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py","lineno":524,"name":"traverse_single"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py","lineno":899,"name":"visit_table"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/sqlalchemy/engine/base.py","lineno":1385,"name":"execute"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py","lineno":80,"name":"_execute_on_connection"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/sqlalchemy/engine/base.py","lineno":1477,"name":"_execute_ddl"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/sqlalchemy/engine/base.py","lineno":1953,"name":"_execute_context"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/sqlalchemy/engine/base.py","lineno":2134,"name":"_handle_dbapi_exception"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/sqlalchemy/util/compat.py","lineno":211,"name":"raise_"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/sqlalchemy/engine/base.py","lineno":1910,"name":"_execute_context"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/sqlalchemy/engine/default.py","lineno":736,"name":"do_execute"}]},{"exc_type":"UniqueViolation","exc_value":"duplicate key value violates unique constraint \"pg_type_typname_nsp_index\"\nDETAIL:  Key (typname, typnamespace)=(transactions, 2200) already exists.\n","exc_notes":[],"syntax_error":null,"is_cause":true,"frames":[{"filename":"/home/airflow/.local/lib/python3.12/site-packages/sqlalchemy/engine/base.py","lineno":1910,"name":"_execute_context"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/sqlalchemy/engine/default.py","lineno":736,"name":"do_execute"}]}]}
{"timestamp":"2025-06-13T04:20:19.097798Z","level":"info","event":"Task instance in failure state","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-13T04:20:19.098362Z","level":"info","event":"Task start","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-13T04:20:19.098703Z","level":"info","event":"Task:<Task(PythonOperator): load>","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-13T04:20:19.098919Z","level":"info","event":"Failure caused by (psycopg2.errors.UniqueViolation) duplicate key value violates unique constraint \"pg_type_typname_nsp_index\"","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-13T04:20:19.099119Z","level":"info","event":"DETAIL:  Key (typname, typnamespace)=(transactions, 2200) already exists.","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-13T04:20:19.099359Z","level":"info","event":"","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-13T04:20:19.099637Z","level":"info","event":"[SQL:","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-13T04:20:19.099783Z","level":"info","event":"CREATE TABLE transactions (","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-13T04:20:19.099901Z","level":"info","event":"\t\"Transaction_ID\" FLOAT(53),","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-13T04:20:19.100008Z","level":"info","event":"\t\"Customer_ID\" FLOAT(53),","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-13T04:20:19.100113Z","level":"info","event":"\t\"Name\" TEXT,","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-13T04:20:19.100220Z","level":"info","event":"\t\"Email\" TEXT,","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-13T04:20:19.100324Z","level":"info","event":"\t\"Phone\" FLOAT(53),","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-13T04:20:19.100430Z","level":"info","event":"\t\"Address\" TEXT,","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-13T04:20:19.100532Z","level":"info","event":"\t\"City\" TEXT,","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-13T04:20:19.100646Z","level":"info","event":"\t\"State\" TEXT,","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-13T04:20:19.100751Z","level":"info","event":"\t\"Zipcode\" FLOAT(53),","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-13T04:20:19.100881Z","level":"info","event":"\t\"Country\" TEXT,","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-13T04:20:19.101013Z","level":"info","event":"\t\"Age\" FLOAT(53),","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-13T04:20:19.101215Z","level":"info","event":"\t\"Gender\" TEXT,","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-13T04:20:19.101381Z","level":"info","event":"\t\"Income\" TEXT,","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-13T04:20:19.101500Z","level":"info","event":"\t\"Customer_Segment\" TEXT,","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-13T04:20:19.101611Z","level":"info","event":"\t\"Date\" TEXT,","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-13T04:20:19.101715Z","level":"info","event":"\t\"Year\" FLOAT(53),","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-13T04:20:19.101821Z","level":"info","event":"\t\"Month\" TEXT,","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-13T04:20:19.101924Z","level":"info","event":"\t\"Time\" TEXT,","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-13T04:20:19.102027Z","level":"info","event":"\t\"Total_Purchases\" FLOAT(53),","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-13T04:20:19.102128Z","level":"info","event":"\t\"Amount\" FLOAT(53),","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-13T04:20:19.102232Z","level":"info","event":"\t\"Total_Amount\" FLOAT(53),","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-13T04:20:19.102371Z","level":"info","event":"\t\"Product_Category\" TEXT,","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-13T04:20:19.102495Z","level":"info","event":"\t\"Product_Brand\" TEXT,","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-13T04:20:19.102601Z","level":"info","event":"\t\"Product_Type\" TEXT,","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-13T04:20:19.102833Z","level":"info","event":"\t\"Feedback\" TEXT,","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-13T04:20:19.103069Z","level":"info","event":"\t\"Shipping_Method\" TEXT,","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-13T04:20:19.103378Z","level":"info","event":"\t\"Payment_Method\" TEXT,","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-13T04:20:19.103557Z","level":"info","event":"\t\"Order_Status\" TEXT,","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-13T04:20:19.103730Z","level":"info","event":"\t\"Ratings\" FLOAT(53),","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-13T04:20:19.103870Z","level":"info","event":"\tproducts TEXT,","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-13T04:20:19.104032Z","level":"info","event":"\t\"Tax\" FLOAT(53)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-13T04:20:19.104301Z","level":"info","event":")","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-13T04:20:19.104501Z","level":"info","event":"","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-13T04:20:19.104638Z","level":"info","event":"]","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-13T04:20:19.104753Z","level":"info","event":"(Background on this error at: https://sqlalche.me/e/14/gkpj)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-13T04:20:19.102425","level":"error","event":"Top level error","logger":"task","error_detail":[{"exc_type":"UndefinedError","exc_value":"'airflow.sdk.execution_time.task_runner.RuntimeTaskInstance object' has no attribute 'log_url'","exc_notes":[],"syntax_error":null,"is_cause":false,"frames":[{"filename":"/home/airflow/.local/lib/python3.12/site-packages/airflow/sdk/execution_time/task_runner.py","lineno":1268,"name":"main"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/airflow/sdk/execution_time/task_runner.py","lineno":1248,"name":"finalize"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/airflow/sdk/execution_time/task_runner.py","lineno":1076,"name":"_send_task_error_email"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/airflow/models/taskinstance.py","lineno":473,"name":"_get_email_subject_content"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/airflow/models/taskinstance.py","lineno":470,"name":"render"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/airflow/utils/helpers.py","lineno":244,"name":"render_template_to_string"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/airflow/utils/helpers.py","lineno":239,"name":"render_template"},{"filename":"<template>","lineno":22,"name":"root"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/jinja2/runtime.py","lineno":859,"name":"_fail_with_undefined_error"}]}]}
{"timestamp":"2025-06-13T04:20:19.116800Z","level":"warning","event":"Process exited abnormally","exit_code":1,"logger":"task"}
